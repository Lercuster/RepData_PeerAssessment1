---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
## Loading libraries

We will need ggplot2 and data.table libraries, let's go load them:

```{r, results='hide'}
library(data.table)
library(ggplot2)
```


## Loading and preprocessing the data

```{r}
if (!file.exists("./data/activity.csv")){
      unzip("activity.zip", exdir = "./data")
} else {
      print("There's no need to unzip!")
}

active_data <- as.data.table(read.csv("./data/activity.csv", header = T))
active_data$date <- as.Date(as.character(active_data$date))
```


## What is mean total number of steps taken per day?

Now i'm going to calculate the total amount of steps taken per day.  
I will notice that activity data set contains some missing values, so i prefer not to remove them
because i think it's more accurate instead of counting them as zeros.
Here i create new dataset based on active_data where i will have 2 columns, for total amount of steps taken per day and corresponding date. 


```{r}
steps_per_day = active_data[, list(steps = sum(steps, na.rm = F)), by = date]
```

Now let's check out the histogram of total number of steps...

```{r}
plot = ggplot(data = steps_per_day, aes(x=steps))+
       geom_histogram(breaks=seq(0, 22000, by = 1000), 
                      color="Black", fill="darkgrey") + 
       labs(title="Steps histogram plot",
           x="Amount of steps per day", y="Days") +
       theme_minimal()

print(plot)
```

... and calculate mean and median number of steps for this dataset.

```{r}
steps_mean = round(mean(steps_per_day$steps, na.rm = T), 2)
steps_median = median(steps_per_day$steps, na.rm = T)
```

As wee can see, the mean value is `r steps_mean` and the median is `r steps_median`.

## What is the average daily activity pattern?

Now let's inspect daily activity. To do that, at firts, i'm going to calculate new data set with 2 columns, first one - average number of steps taken during 5-minute interval and the second column - corresonding interval.

```{r}
num_steps_int <- active_data[, list(steps = mean(steps, na.rm=T)), 
                                                by=interval]
```

Now let's visualize this data by creating time-series plot of 5-minute interval (x-axis) and number of steps (y-axis).

```{r}
plot = ggplot(data = num_steps_int, 
              aes(x = interval, y = steps)) + 
       geom_line() + 
       labs(title="The average  number of steps taken 
                   in certain 5-minute interval", x = "5-minute unterval", 
                   y = "Number of steps taken") + 
       theme_light()
print(plot)
```

And let's find out certain interval in which wee have maximum of steps:

```{r}
pair = num_steps_int[steps == max(steps), ]
pair$steps = round(pair$steps, 2)
```

It turns out that data have maximum of `r pair[1, 2]` steps in `r pair[1, 1]` interval.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
